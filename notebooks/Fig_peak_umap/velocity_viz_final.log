================================================================================
CHROMATIN VELOCITY FINAL VISUALIZATION
================================================================================

Initializing visualizer...

1. Loading pre-computed velocity data...
   Path: peak_umap_chromatin_velocity_connectivity_smoothed.h5ad
   ✓ Loaded: (640830, 190)
   ✓ UMAP: (640830, 2)
   ✓ Velocity: (640830, 2)
   ✓ Magnitude: mean=2.975, median=1.926
   ✓ Timepoints: ['0somites', '10somites', '15somites', '20somites', '30somites', '5somites']

2. Interpolating velocity to 60×60 grid...
   ✓ Grid interpolation complete
   Grid velocity: U[-5.928, 16.503], V[-1.731, 1.740]

================================================================================
GENERATING VISUALIZATIONS
================================================================================

3. Creating streamplot visualization (density=1.5)...
   ✓ Saved: chromatin_velocity_streamplot_density1.5.png

3. Creating streamplot visualization (density=2.0)...
   ✓ Saved: chromatin_velocity_streamplot_density2.0.png

3. Creating streamplot visualization (density=2.5)...
   ✓ Saved: chromatin_velocity_streamplot_density2.5.png

4. Creating arrow visualization (5000 arrows, grid sampling)...

   Grid-based sampling: 5000 arrows...
   ✓ Sampled 1822 arrows
   ✓ Saved: chromatin_velocity_arrows_grid_5000.png

4. Creating arrow visualization (5000 arrows, adaptive sampling)...

   Adaptive sampling: 5000 arrows (min_dist=0.4)...
   ✓ Sampled 1137 arrows
   ✓ Saved: chromatin_velocity_arrows_adaptive_5000.png

4. Creating arrow visualization (5000 arrows, weighted sampling)...

   Velocity-weighted sampling: 5000 arrows...
   ✓ Sampled 5000 arrows
   ✓ Saved: chromatin_velocity_arrows_weighted_5000.png

5. Creating combined 4-panel visualization...

   Grid-based sampling: 3000 arrows...
   ✓ Sampled 1148 arrows

   Adaptive sampling: 1500 arrows (min_dist=0.6)...
   ✓ Sampled 550 arrows
Traceback (most recent call last):
  File "/hpc/projects/data.science/yangjoon.kim/zebrahub_multiome/zebrahub-multiome-analysis/notebooks/Fig_peak_umap/visualize_chromatin_velocity_final.py", line 531, in <module>
    result = main()
  File "/hpc/projects/data.science/yangjoon.kim/zebrahub_multiome/zebrahub-multiome-analysis/notebooks/Fig_peak_umap/visualize_chromatin_velocity_final.py", line 515, in main
    visualizer.create_combined_panel(streamline_density=2.0, n_arrows=3000)
  File "/hpc/projects/data.science/yangjoon.kim/zebrahub_multiome/zebrahub-multiome-analysis/notebooks/Fig_peak_umap/visualize_chromatin_velocity_final.py", line 432, in create_combined_panel
    ax3.streamplot(
  File "/hpc/user_apps/data.science/conda_envs/celloracle_shared/lib/python3.10/site-packages/matplotlib/__init__.py", line 1433, in inner
    return func(ax, *map(sanitize_sequence, args), **kwargs)
TypeError: streamplot() got an unexpected keyword argument 'alpha'
