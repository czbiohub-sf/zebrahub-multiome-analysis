================================================================================
LINEAGE DYNAMICS ANALYSIS
================================================================================

Loaded 60 ranked clusters
Loaded 189 GRN combinations
Loaded 346 cluster matrices

================================================================================
ANALYZING LINEAGE DYNAMICS...
================================================================================
Processed 10/60 clusters...
Processed 20/60 clusters...
Processed 30/60 clusters...
Processed 40/60 clusters...
Processed 50/60 clusters...
Processed 60/60 clusters...

Found 49 clusters with valid lineage dynamics

================================================================================
LINEAGE BIAS DISTRIBUTION:
================================================================================
Neural-biased (bias > 0.3): 1 clusters
Mesoderm-biased (bias < -0.3): 0 clusters
Balanced (|bias| <= 0.3): 48 clusters

================================================================================
TOP 10 CANDIDATES WITH STRONGEST LINEAGE DYNAMICS:
================================================================================

1. Cluster 3_2 - hindbrain (NEURAL-biased)
   Peak timepoint: 20
   Lineage dynamics score: 0.710
   Lineage bias: 0.261 (NEURAL)
   Neural strength: 11.2, Pattern: progressive_weakening
   Mesoderm strength: 6.6, Pattern: progressive_strengthening
   Avg edges: 16.1, Avg nodes: 14.2
   Neural celltypes (3): ['neural_posterior', 'spinal_cord', 'NMPs']
   Mesoderm celltypes (5): ['NMPs', 'tail_bud', 'PSM', 'somites', 'fast_muscle']
   Neural edge counts: [29, 26, 10]
   Mesoderm edge counts: [10, 11, 15, 11, 17]
   All dev TFs (9): ['pax6a', 'pax6b', 'sox11a', 'sox13', 'sox21a', 'sox3', 'sox5', 'sox6', 'sox7']
   Neural TFs (9): ['pax6a', 'pax6b', 'sox11a', 'sox13', 'sox21a', 'sox3', 'sox5', 'sox6', 'sox7']
   Mesoderm TFs (5): ['pax6a', 'pax6b', 'sox13', 'sox3', 'sox6']

2. Cluster 3_8 - neural_telencephalon (NEURAL-biased)
   Peak timepoint: 20
   Lineage dynamics score: 0.703
   Lineage bias: 0.242 (NEURAL)
   Neural strength: 16.2, Pattern: progressive_weakening
   Mesoderm strength: 9.9, Pattern: progressive_weakening
   Avg edges: 23.6, Avg nodes: 22.1
   Neural celltypes (3): ['neural_posterior', 'spinal_cord', 'NMPs']
   Mesoderm celltypes (5): ['NMPs', 'tail_bud', 'PSM', 'somites', 'fast_muscle']
   Neural edge counts: [48, 27, 18]
   Mesoderm edge counts: [18, 17, 23, 21, 17]
   All dev TFs (15): ['hoxa4a', 'hoxb3a', 'meox1', 'nkx2.1', 'nkx2.2a', 'pax6a', 'pax6b', 'phox2bb', 'sox10', 'sox11a', 'sox13', 'sox21a', 'sox3', 'sox5', 'sox6']
   Neural TFs (15): ['hoxa4a', 'hoxb3a', 'meox1', 'nkx2.1', 'nkx2.2a', 'pax6a', 'pax6b', 'phox2bb', 'sox10', 'sox11a', 'sox13', 'sox21a', 'sox3', 'sox5', 'sox6']
   Mesoderm TFs (12): ['hoxa4a', 'hoxb3a', 'meox1', 'nkx2.1', 'nkx2.2a', 'pax6a', 'pax6b', 'phox2bb', 'sox11a', 'sox13', 'sox3', 'sox6']

3. Cluster 2_2 - enteric_neurons (NEURAL-biased)
   Peak timepoint: 10
   Lineage dynamics score: 0.702
   Lineage bias: 0.327 (NEURAL)
   Neural strength: 13.6, Pattern: progressive_weakening
   Mesoderm strength: 6.9, Pattern: peaked
   Avg edges: 18.2, Avg nodes: 17.8
   Neural celltypes (3): ['neural_posterior', 'spinal_cord', 'NMPs']
   Mesoderm celltypes (5): ['NMPs', 'tail_bud', 'PSM', 'somites', 'fast_muscle']
   Neural edge counts: [35, 31, 13]
   Mesoderm edge counts: [13, 11, 15, 17, 11]
   All dev TFs (24): ['hoxa4a', 'hoxb1b', 'hoxb3a', 'meox1', 'nkx1.2la', 'pax3a', 'pax3b', 'pax7a', 'pax7b', 'phox2a', 'sox11a', 'sox11b', 'sox13', 'sox18', 'sox19a', 'sox19b', 'sox1b', 'sox2', 'sox21a', 'sox3', 'sox5', 'sox6', 'sox7', 'sox9b']
   Neural TFs (21): ['hoxa4a', 'hoxb1b', 'hoxb3a', 'nkx1.2la', 'pax3a', 'pax7a', 'pax7b', 'phox2a', 'sox11a', 'sox11b', 'sox13', 'sox18', 'sox19a', 'sox19b', 'sox2', 'sox21a', 'sox3', 'sox5', 'sox6', 'sox7', 'sox9b']
   Mesoderm TFs (16): ['meox1', 'pax3a', 'pax3b', 'pax7a', 'pax7b', 'sox11a', 'sox11b', 'sox13', 'sox19a', 'sox19b', 'sox1b', 'sox2', 'sox21a', 'sox3', 'sox5', 'sox7']

4. Cluster 22_16 - muscle (MESODERM-biased)
   Peak timepoint: 10
   Lineage dynamics score: 0.694
   Lineage bias: -0.214 (MESODERM)
   Neural strength: 7.8, Pattern: progressive_strengthening
   Mesoderm strength: 12.0, Pattern: progressive_weakening
   Avg edges: 20.1, Avg nodes: 17.2
   Neural celltypes (3): ['neural_posterior', 'spinal_cord', 'NMPs']
   Mesoderm celltypes (5): ['NMPs', 'tail_bud', 'PSM', 'somites', 'fast_muscle']
   Neural edge counts: [10, 17, 18]
   Mesoderm edge counts: [18, 35, 29, 20, 14]
   All dev TFs (12): ['olig2', 'sox11a', 'sox11b', 'sox13', 'sox18', 'sox19a', 'sox19b', 'sox2', 'sox5', 'sox6', 'sox7', 'sox9b']
   Neural TFs (5): ['olig2', 'sox11a', 'sox11b', 'sox2', 'sox5']
   Mesoderm TFs (10): ['olig2', 'sox13', 'sox18', 'sox19a', 'sox19b', 'sox2', 'sox5', 'sox6', 'sox7', 'sox9b']

5. Cluster 17_7 - tail_bud (MESODERM-biased)
   Peak timepoint: 05
   Lineage dynamics score: 0.681
   Lineage bias: -0.178 (MESODERM)
   Neural strength: 8.8, Pattern: progressive_strengthening
   Mesoderm strength: 12.5, Pattern: progressive_weakening
   Avg edges: 21.6, Avg nodes: 23.0
   Neural celltypes (3): ['neural_posterior', 'spinal_cord', 'NMPs']
   Mesoderm celltypes (5): ['NMPs', 'tail_bud', 'PSM', 'somites', 'fast_muscle']
   Neural edge counts: [11, 12, 28]
   Mesoderm edge counts: [28, 24, 22, 21, 27]
   All dev TFs (6): ['hoxa4a', 'hoxb3a', 'meox1', 'pax3a', 'pax3b', 'pax7b']
   Neural TFs (5): ['hoxa4a', 'hoxb3a', 'meox1', 'pax3a', 'pax7b']
   Mesoderm TFs (6): ['hoxa4a', 'hoxb3a', 'meox1', 'pax3a', 'pax3b', 'pax7b']

6. Cluster 3_9 - neural_floor_plate (NEURAL-biased)
   Peak timepoint: 10
   Lineage dynamics score: 0.681
   Lineage bias: 0.266 (NEURAL)
   Neural strength: 15.6, Pattern: progressive_weakening
   Mesoderm strength: 9.0, Pattern: peaked
   Avg edges: 22.4, Avg nodes: 20.8
   Neural celltypes (3): ['neural_posterior', 'spinal_cord', 'NMPs']
   Mesoderm celltypes (5): ['NMPs', 'tail_bud', 'PSM', 'somites', 'fast_muscle']
   Neural edge counts: [38, 32, 21]
   Mesoderm edge counts: [21, 14, 18, 22, 13]
   All dev TFs (17): ['hoxa4a', 'hoxb3a', 'hoxc1a', 'pax6a', 'pax6b', 'sox11a', 'sox11b', 'sox13', 'sox19a', 'sox19b', 'sox1b', 'sox2', 'sox21a', 'sox3', 'sox5', 'sox6', 'sox7']
   Neural TFs (16): ['hoxa4a', 'hoxb3a', 'hoxc1a', 'pax6a', 'pax6b', 'sox11a', 'sox11b', 'sox13', 'sox19a', 'sox19b', 'sox1b', 'sox2', 'sox21a', 'sox3', 'sox5', 'sox6']
   Mesoderm TFs (16): ['hoxa4a', 'hoxb3a', 'pax6a', 'pax6b', 'sox11a', 'sox11b', 'sox13', 'sox19a', 'sox19b', 'sox1b', 'sox2', 'sox21a', 'sox3', 'sox5', 'sox6', 'sox7']

7. Cluster 26_10 - neural_floor_plate (NEURAL-biased)
   Peak timepoint: 00
   Lineage dynamics score: 0.666
   Lineage bias: 0.164 (NEURAL)
   Neural strength: 11.9, Pattern: progressive_weakening
   Mesoderm strength: 8.5, Pattern: progressive_weakening
   Avg edges: 19.3, Avg nodes: 19.6
   Neural celltypes (3): ['neural_posterior', 'spinal_cord', 'NMPs']
   Mesoderm celltypes (4): ['NMPs', 'tail_bud', 'PSM', 'somites']
   Neural edge counts: [29, 27, 13]
   Mesoderm edge counts: [13, 11, 24, 18]
   All dev TFs (13): ['sox11a', 'sox13', 'sox17', 'sox19a', 'sox19b', 'sox1a', 'sox1b', 'sox2', 'sox21a', 'sox3', 'sox5', 'sox6', 'sox7']
   Neural TFs (11): ['sox11a', 'sox13', 'sox17', 'sox19a', 'sox19b', 'sox1a', 'sox1b', 'sox21a', 'sox3', 'sox5', 'sox7']
   Mesoderm TFs (11): ['sox11a', 'sox13', 'sox17', 'sox19a', 'sox19b', 'sox1b', 'sox2', 'sox21a', 'sox3', 'sox5', 'sox6']

8. Cluster 3_7 - optic_cup (NEURAL-biased)
   Peak timepoint: 20
   Lineage dynamics score: 0.655
   Lineage bias: 0.104 (NEURAL)
   Neural strength: 16.9, Pattern: progressive_weakening
   Mesoderm strength: 13.7, Pattern: progressive_strengthening
   Avg edges: 28.8, Avg nodes: 20.8
   Neural celltypes (3): ['neural_posterior', 'spinal_cord', 'NMPs']
   Mesoderm celltypes (5): ['NMPs', 'tail_bud', 'PSM', 'somites', 'fast_muscle']
   Neural edge counts: [47, 35, 15]
   Mesoderm edge counts: [15, 25, 33, 36, 24]
   All dev TFs (6): ['pax2a', 'pax3a', 'pax6a', 'pax6b', 'pax7a', 'pax7b']
   Neural TFs (5): ['pax3a', 'pax6a', 'pax6b', 'pax7a', 'pax7b']
   Mesoderm TFs (6): ['pax2a', 'pax3a', 'pax6a', 'pax6b', 'pax7a', 'pax7b']

9. Cluster 10_6 - muscle (MESODERM-biased)
   Peak timepoint: 15
   Lineage dynamics score: 0.644
   Lineage bias: -0.242 (MESODERM)
   Neural strength: 17.8, Pattern: progressive_strengthening
   Mesoderm strength: 29.2, Pattern: progressive_weakening
   Avg edges: 48.0, Avg nodes: 27.6
   Neural celltypes (3): ['neural_posterior', 'spinal_cord', 'NMPs']
   Mesoderm celltypes (5): ['NMPs', 'tail_bud', 'PSM', 'somites', 'fast_muscle']
   Neural edge counts: [16, 34, 53]
   Mesoderm edge counts: [53, 66, 57, 55, 50]
   All dev TFs (5): ['hoxa4a', 'hoxb3a', 'hoxd3a', 'meox1', 'nkx1.2la']
   Neural TFs (5): ['hoxa4a', 'hoxb3a', 'hoxd3a', 'meox1', 'nkx1.2la']
   Mesoderm TFs (5): ['hoxa4a', 'hoxb3a', 'hoxd3a', 'meox1', 'nkx1.2la']

10. Cluster 14_1 - heart_myocardium (NEURAL-biased)
   Peak timepoint: 10
   Lineage dynamics score: 0.629
   Lineage bias: 0.028 (NEURAL)
   Neural strength: 9.7, Pattern: progressive_weakening
   Mesoderm strength: 9.2, Pattern: progressive_weakening
   Avg edges: 18.4, Avg nodes: 18.5
   Neural celltypes (3): ['neural_posterior', 'spinal_cord', 'NMPs']
   Mesoderm celltypes (5): ['NMPs', 'tail_bud', 'PSM', 'somites', 'fast_muscle']
   Neural edge counts: [20, 19, 18]
   Mesoderm edge counts: [18, 15, 14, 25, 18]
   All dev TFs (5): ['gata2a', 'gata3', 'gata5', 'gata6', 'olig2']
   Neural TFs (4): ['gata2a', 'gata3', 'gata5', 'olig2']
   Mesoderm TFs (4): ['gata2a', 'gata5', 'gata6', 'olig2']

================================================================================
TOP 5 NEURAL-BIASED CANDIDATES:
================================================================================

1. Cluster 3_2 - hindbrain
   Lineage bias: 0.261
   Score: 0.710
   Neural: 11.2 (progressive_weakening)
   Mesoderm: 6.6 (progressive_strengthening)

2. Cluster 3_8 - neural_telencephalon
   Lineage bias: 0.242
   Score: 0.703
   Neural: 16.2 (progressive_weakening)
   Mesoderm: 9.9 (progressive_weakening)

3. Cluster 2_2 - enteric_neurons
   Lineage bias: 0.327
   Score: 0.702
   Neural: 13.6 (progressive_weakening)
   Mesoderm: 6.9 (peaked)

4. Cluster 3_9 - neural_floor_plate
   Lineage bias: 0.266
   Score: 0.681
   Neural: 15.6 (progressive_weakening)
   Mesoderm: 9.0 (peaked)

5. Cluster 26_10 - neural_floor_plate
   Lineage bias: 0.164
   Score: 0.666
   Neural: 11.9 (progressive_weakening)
   Mesoderm: 8.5 (progressive_weakening)

================================================================================
TOP 5 MESODERM-BIASED CANDIDATES:
================================================================================

1. Cluster 22_16 - muscle
   Lineage bias: -0.214
   Score: 0.694
   Neural: 7.8 (progressive_strengthening)
   Mesoderm: 12.0 (progressive_weakening)

2. Cluster 17_7 - tail_bud
   Lineage bias: -0.178
   Score: 0.681
   Neural: 8.8 (progressive_strengthening)
   Mesoderm: 12.5 (progressive_weakening)

3. Cluster 10_6 - muscle
   Lineage bias: -0.242
   Score: 0.644
   Neural: 17.8 (progressive_strengthening)
   Mesoderm: 29.2 (progressive_weakening)

4. Cluster 25_3 - hematopoietic_vasculature
   Lineage bias: -0.223
   Score: 0.603
   Neural: 8.9 (dipped)
   Mesoderm: 13.9 (peaked)

5. Cluster 13_9 - muscle
   Lineage bias: -0.028
   Score: 0.597
   Neural: 8.7 (progressive_strengthening)
   Mesoderm: 9.2 (dipped)

================================================================================
Results saved to: /hpc/projects/data.science/yangjoon.kim/zebrahub_multiome/zebrahub-multiome-analysis/figures/sub_GRNs_reg_programs/lineage_dynamics_ranking.csv
================================================================================
