================================================================================
TEMPORAL DYNAMICS RANKING PIPELINE
================================================================================

1. Loading data...
   ✓ Loaded df_clusters_groups (raw): (402, 190)
   ✓ Filtered out 14 low-cell groups (< 20 cells)
   ✓ Retained df_clusters_groups: (402, 176)
   ✓ Loaded GRN dictionary: 189 celltype×timepoint combinations
   ✓ Loaded cluster_tf_gene_matrices: 346 clusters

2. Defining analysis functions...

================================================================================

3. Starting analysis of 346 clusters...
   Filters: min_edges_per_timepoint=5, min_timepoints_with_edges=3
Processing clusters:   0%|          | 0/346 [00:00<?, ?it/s]Processing clusters:   1%|          | 2/346 [00:00<00:28, 11.99it/s]Processing clusters:   1%|          | 4/346 [00:00<00:42,  8.13it/s]Processing clusters:   1%|▏         | 5/346 [00:00<00:41,  8.19it/s]Processing clusters:   2%|▏         | 7/346 [00:01<01:09,  4.88it/s]Processing clusters:   2%|▏         | 8/346 [00:01<01:01,  5.52it/s]Processing clusters:   3%|▎         | 10/346 [00:01<00:50,  6.69it/s]Processing clusters:   3%|▎         | 11/346 [00:01<00:54,  6.18it/s]Processing clusters:   4%|▍         | 13/346 [00:01<00:43,  7.73it/s]Processing clusters:   4%|▍         | 15/346 [00:02<00:37,  8.81it/s]Processing clusters:   5%|▍         | 17/346 [00:02<00:34,  9.62it/s]Processing clusters:   5%|▌         | 19/346 [00:02<00:32, 10.20it/s]Processing clusters:   6%|▌         | 21/346 [00:02<00:40,  8.08it/s]Processing clusters:   6%|▋         | 22/346 [00:02<00:41,  7.80it/s]Processing clusters:   7%|▋         | 24/346 [00:03<00:38,  8.27it/s]Processing clusters:   7%|▋         | 25/346 [00:03<00:38,  8.27it/s]Processing clusters:   8%|▊         | 27/346 [00:03<00:35,  8.95it/s]Processing clusters:   8%|▊         | 29/346 [00:03<00:37,  8.53it/s]Processing clusters:   9%|▉         | 31/346 [00:04<00:42,  7.46it/s]Processing clusters:  10%|▉         | 33/346 [00:04<00:37,  8.36it/s]Processing clusters:  10%|█         | 35/346 [00:04<00:33,  9.21it/s]Processing clusters:  11%|█         | 37/346 [00:04<00:30, 10.26it/s]Processing clusters:  11%|█▏        | 39/346 [00:04<00:28, 10.84it/s]Processing clusters:  12%|█▏        | 41/346 [00:04<00:26, 11.32it/s]Processing clusters:  12%|█▏        | 43/346 [00:04<00:26, 11.41it/s]Processing clusters:  13%|█▎        | 45/346 [00:05<00:31,  9.45it/s]Processing clusters:  14%|█▎        | 47/346 [00:05<00:29, 10.31it/s]Processing clusters:  14%|█▍        | 49/346 [00:05<00:26, 11.02it/s]Processing clusters:  15%|█▍        | 51/346 [00:05<00:29, 10.13it/s]Processing clusters:  15%|█▌        | 53/346 [00:06<00:41,  6.98it/s]Processing clusters:  16%|█▌        | 54/346 [00:06<00:40,  7.24it/s]Processing clusters:  16%|█▌        | 55/346 [00:06<00:38,  7.57it/s]Processing clusters:  16%|█▋        | 57/346 [00:06<00:34,  8.31it/s]Processing clusters:  17%|█▋        | 59/346 [00:06<00:30,  9.28it/s]Processing clusters:  18%|█▊        | 61/346 [00:07<00:39,  7.21it/s]Processing clusters:  18%|█▊        | 63/346 [00:07<00:34,  8.29it/s]Processing clusters:  18%|█▊        | 64/346 [00:07<00:41,  6.78it/s]Processing clusters:  19%|█▉        | 66/346 [00:07<00:35,  7.96it/s]Processing clusters:  19%|█▉        | 67/346 [00:08<00:35,  7.77it/s]Processing clusters:  20%|█▉        | 69/346 [00:08<00:31,  8.90it/s]Processing clusters:  20%|██        | 70/346 [00:08<00:31,  8.81it/s]Processing clusters:  21%|██        | 72/346 [00:08<00:28,  9.76it/s]Processing clusters:  21%|██▏       | 74/346 [00:08<00:26, 10.32it/s]Processing clusters:  22%|██▏       | 76/346 [00:08<00:29,  9.11it/s]Processing clusters:  23%|██▎       | 78/346 [00:09<00:27,  9.89it/s]Processing clusters:  23%|██▎       | 80/346 [00:09<00:25, 10.36it/s]Processing clusters:  24%|██▎       | 82/346 [00:09<00:24, 10.65it/s]Processing clusters:  24%|██▍       | 84/346 [00:09<00:25, 10.29it/s]Processing clusters:  25%|██▍       | 86/346 [00:09<00:23, 11.00it/s]Processing clusters:  25%|██▌       | 88/346 [00:09<00:22, 11.31it/s]Processing clusters:  26%|██▌       | 90/346 [00:10<00:23, 10.81it/s]Processing clusters:  27%|██▋       | 92/346 [00:10<00:23, 10.92it/s]Processing clusters:  27%|██▋       | 94/346 [00:10<00:22, 11.25it/s]Processing clusters:  28%|██▊       | 96/346 [00:10<00:22, 11.25it/s]Processing clusters:  28%|██▊       | 98/346 [00:10<00:25,  9.79it/s]Processing clusters:  29%|██▉       | 100/346 [00:11<00:25,  9.55it/s]Processing clusters:  29%|██▉       | 101/346 [00:11<00:25,  9.60it/s]Processing clusters:  30%|██▉       | 103/346 [00:11<00:24,  9.78it/s]Processing clusters:  30%|███       | 105/346 [00:11<00:26,  9.11it/s]Processing clusters:  31%|███       | 106/346 [00:11<00:26,  8.93it/s]Processing clusters:  31%|███       | 108/346 [00:12<00:24,  9.69it/s]Processing clusters:  32%|███▏      | 110/346 [00:12<00:23, 10.18it/s]Processing clusters:  32%|███▏      | 112/346 [00:12<00:28,  8.27it/s]Processing clusters:  33%|███▎      | 114/346 [00:12<00:25,  9.12it/s]Processing clusters:  34%|███▎      | 116/346 [00:12<00:23,  9.74it/s]Processing clusters:  34%|███▍      | 118/346 [00:13<00:21, 10.38it/s]Processing clusters:  35%|███▍      | 120/346 [00:13<00:21, 10.66it/s]Processing clusters:  35%|███▌      | 122/346 [00:13<00:20, 11.08it/s]Processing clusters:  36%|███▌      | 124/346 [00:13<00:19, 11.64it/s]Processing clusters:  36%|███▋      | 126/346 [00:13<00:18, 12.00it/s]Processing clusters:  37%|███▋      | 128/346 [00:14<00:26,  8.29it/s]Processing clusters:  37%|███▋      | 129/346 [00:14<00:26,  8.09it/s]Processing clusters:  38%|███▊      | 130/346 [00:14<00:25,  8.32it/s]Processing clusters:  38%|███▊      | 132/346 [00:14<00:22,  9.33it/s]Processing clusters:  39%|███▊      | 134/346 [00:14<00:21,  9.82it/s]Processing clusters:  39%|███▉      | 136/346 [00:14<00:20, 10.39it/s]Processing clusters:  40%|███▉      | 138/346 [00:15<00:24,  8.52it/s]Processing clusters:  40%|████      | 140/346 [00:15<00:24,  8.53it/s]Processing clusters:  41%|████      | 142/346 [00:15<00:21,  9.46it/s]Processing clusters:  42%|████▏     | 144/346 [00:15<00:19, 10.16it/s]Processing clusters:  42%|████▏     | 146/346 [00:15<00:18, 10.66it/s]Processing clusters:  43%|████▎     | 148/346 [00:16<00:18, 10.44it/s]Processing clusters:  43%|████▎     | 150/346 [00:16<00:17, 11.06it/s]Processing clusters:  44%|████▍     | 152/346 [00:16<00:17, 11.09it/s]Processing clusters:  45%|████▍     | 154/346 [00:16<00:16, 11.40it/s]Processing clusters:  45%|████▌     | 156/346 [00:16<00:16, 11.25it/s]Processing clusters:  46%|████▌     | 158/346 [00:16<00:15, 11.82it/s]Processing clusters:  46%|████▌     | 160/346 [00:17<00:15, 11.67it/s]Processing clusters:  47%|████▋     | 162/346 [00:17<00:16, 11.10it/s]Processing clusters:  47%|████▋     | 164/346 [00:17<00:19,  9.31it/s]Processing clusters:  48%|████▊     | 166/346 [00:17<00:19,  9.36it/s]Processing clusters:  49%|████▊     | 168/346 [00:18<00:18,  9.67it/s]Processing clusters:  49%|████▉     | 170/346 [00:18<00:17, 10.31it/s]Processing clusters:  50%|████▉     | 172/346 [00:18<00:16, 10.81it/s]Processing clusters:  50%|█████     | 174/346 [00:18<00:15, 11.21it/s]Processing clusters:  51%|█████     | 176/346 [00:18<00:15, 10.64it/s]Processing clusters:  51%|█████▏    | 178/346 [00:18<00:15, 11.06it/s]Processing clusters:  52%|█████▏    | 180/346 [00:19<00:14, 11.42it/s]Processing clusters:  53%|█████▎    | 182/346 [00:19<00:14, 11.58it/s]Processing clusters:  53%|█████▎    | 184/346 [00:19<00:14, 10.93it/s]Processing clusters:  54%|█████▍    | 186/346 [00:19<00:14, 11.29it/s]Processing clusters:  54%|█████▍    | 188/346 [00:19<00:13, 11.48it/s]Processing clusters:  55%|█████▍    | 190/346 [00:19<00:13, 11.41it/s]Processing clusters:  55%|█████▌    | 192/346 [00:20<00:13, 11.55it/s]Processing clusters:  56%|█████▌    | 194/346 [00:20<00:12, 11.99it/s]Processing clusters:  57%|█████▋    | 196/346 [00:20<00:12, 12.03it/s]Processing clusters:  57%|█████▋    | 198/346 [00:20<00:13, 10.57it/s]Processing clusters:  58%|█████▊    | 200/346 [00:20<00:13, 10.64it/s]Processing clusters:  58%|█████▊    | 202/346 [00:21<00:13, 10.79it/s]Processing clusters:  59%|█████▉    | 204/346 [00:21<00:16,  8.43it/s]Processing clusters:  60%|█████▉    | 206/346 [00:21<00:15,  9.20it/s]Processing clusters:  60%|██████    | 208/346 [00:21<00:15,  9.01it/s]Processing clusters:  61%|██████    | 210/346 [00:21<00:13,  9.72it/s]Processing clusters:  61%|██████▏   | 212/346 [00:22<00:12, 10.35it/s]Processing clusters:  62%|██████▏   | 214/346 [00:22<00:12, 10.20it/s]Processing clusters:  62%|██████▏   | 216/346 [00:22<00:12, 10.23it/s]Processing clusters:  63%|██████▎   | 218/346 [00:22<00:12, 10.57it/s]Processing clusters:  64%|██████▎   | 220/346 [00:22<00:11, 11.03it/s]Processing clusters:  64%|██████▍   | 222/346 [00:23<00:10, 11.37it/s]Processing clusters:  65%|██████▍   | 224/346 [00:23<00:11, 10.97it/s]Processing clusters:  65%|██████▌   | 226/346 [00:23<00:10, 11.25it/s]Processing clusters:  66%|██████▌   | 228/346 [00:23<00:10, 11.42it/s]Processing clusters:  66%|██████▋   | 230/346 [00:23<00:09, 11.64it/s]Processing clusters:  67%|██████▋   | 232/346 [00:23<00:09, 11.91it/s]Processing clusters:  68%|██████▊   | 234/346 [00:24<00:09, 11.96it/s]Processing clusters:  68%|██████▊   | 236/346 [00:24<00:09, 11.94it/s]Processing clusters:  69%|██████▉   | 238/346 [00:24<00:09, 11.25it/s]Processing clusters:  69%|██████▉   | 240/346 [00:24<00:09, 11.16it/s]Processing clusters:  70%|██████▉   | 242/346 [00:24<00:09, 11.42it/s]Processing clusters:  71%|███████   | 244/346 [00:24<00:08, 11.55it/s]Processing clusters:  71%|███████   | 246/346 [00:25<00:08, 11.65it/s]Processing clusters:  72%|███████▏  | 248/346 [00:25<00:08, 11.16it/s]Processing clusters:  72%|███████▏  | 250/346 [00:25<00:08, 11.97it/s]Processing clusters:  73%|███████▎  | 252/346 [00:25<00:07, 12.05it/s]Processing clusters:  73%|███████▎  | 254/346 [00:25<00:07, 12.00it/s]Processing clusters:  74%|███████▍  | 256/346 [00:25<00:07, 11.91it/s]Processing clusters:  75%|███████▍  | 258/346 [00:26<00:07, 12.02it/s]Processing clusters:  75%|███████▌  | 260/346 [00:26<00:06, 12.39it/s]Processing clusters:  76%|███████▌  | 262/346 [00:26<00:06, 12.27it/s]Processing clusters:  76%|███████▋  | 264/346 [00:26<00:06, 12.20it/s]Processing clusters:  77%|███████▋  | 266/346 [00:26<00:06, 12.15it/s]Processing clusters:  77%|███████▋  | 268/346 [00:26<00:06, 12.21it/s]Processing clusters:  78%|███████▊  | 270/346 [00:27<00:06, 11.90it/s]Processing clusters:  79%|███████▊  | 272/346 [00:27<00:06, 11.99it/s]Processing clusters:  79%|███████▉  | 274/346 [00:27<00:06, 11.00it/s]Processing clusters:  80%|███████▉  | 276/346 [00:27<00:06, 11.11it/s]Processing clusters:  80%|████████  | 278/346 [00:27<00:06, 11.11it/s]Processing clusters:  81%|████████  | 280/346 [00:28<00:05, 11.36it/s]Processing clusters:  82%|████████▏ | 282/346 [00:28<00:05, 11.56it/s]Processing clusters:  82%|████████▏ | 284/346 [00:28<00:05, 11.38it/s]Processing clusters:  83%|████████▎ | 286/346 [00:28<00:05, 10.19it/s]Processing clusters:  83%|████████▎ | 288/346 [00:28<00:05, 10.65it/s]Processing clusters:  84%|████████▍ | 290/346 [00:28<00:05, 11.04it/s]Processing clusters:  84%|████████▍ | 292/346 [00:29<00:04, 11.09it/s]Processing clusters:  85%|████████▍ | 294/346 [00:29<00:05,  8.88it/s]Processing clusters:  85%|████████▌ | 295/346 [00:29<00:06,  7.36it/s]Processing clusters:  86%|████████▌ | 297/346 [00:29<00:05,  8.64it/s]Processing clusters:  86%|████████▋ | 299/346 [00:30<00:05,  9.11it/s]Processing clusters:  87%|████████▋ | 301/346 [00:30<00:05,  9.00it/s]Processing clusters:  88%|████████▊ | 303/346 [00:30<00:04,  9.78it/s]Processing clusters:  88%|████████▊ | 305/346 [00:30<00:03, 10.40it/s]Processing clusters:  89%|████████▊ | 307/346 [00:30<00:03, 10.50it/s]Processing clusters:  89%|████████▉ | 309/346 [00:30<00:03, 10.86it/s]Processing clusters:  90%|████████▉ | 311/346 [00:31<00:03, 11.39it/s]Processing clusters:  90%|█████████ | 313/346 [00:31<00:02, 11.46it/s]Processing clusters:  91%|█████████ | 315/346 [00:31<00:02, 11.67it/s]Processing clusters:  92%|█████████▏| 317/346 [00:31<00:02, 11.64it/s]Processing clusters:  92%|█████████▏| 319/346 [00:31<00:02, 11.72it/s]Processing clusters:  93%|█████████▎| 321/346 [00:31<00:02, 11.78it/s]Processing clusters:  93%|█████████▎| 323/346 [00:32<00:01, 11.97it/s]Processing clusters:  94%|█████████▍| 325/346 [00:32<00:01, 12.01it/s]Processing clusters:  95%|█████████▍| 327/346 [00:32<00:01, 12.01it/s]Processing clusters:  95%|█████████▌| 329/346 [00:32<00:01, 11.42it/s]Processing clusters:  96%|█████████▌| 331/346 [00:32<00:01, 11.27it/s]Processing clusters:  96%|█████████▌| 333/346 [00:33<00:01, 11.23it/s]Processing clusters:  97%|█████████▋| 335/346 [00:33<00:00, 11.45it/s]Processing clusters:  97%|█████████▋| 337/346 [00:33<00:00, 11.44it/s]Processing clusters:  98%|█████████▊| 339/346 [00:33<00:00, 11.28it/s]Processing clusters:  99%|█████████▊| 341/346 [00:33<00:00, 11.56it/s]Processing clusters:  99%|█████████▉| 343/346 [00:33<00:00, 11.60it/s]Processing clusters: 100%|█████████▉| 345/346 [00:34<00:00, 11.64it/s]Processing clusters: 100%|██████████| 346/346 [00:34<00:00, 10.13it/s]

   ✓ Ranking table saved to: /hpc/projects/data.science/yangjoon.kim/zebrahub_multiome/zebrahub-multiome-analysis/figures/sub_GRNs_reg_programs/cluster_ranking_temporal_dynamics.csv

================================================================================
RANKING SUMMARY
================================================================================
Total clusters analyzed: 83
Dynamics score range: 0.474 - 1.010
Median dynamics score: 0.937

Top 10 most dynamic clusters:
cluster_id                  celltype  dynamics_score  n_developmental_tfs                       developmental_tfs_list
      25_6 hematopoietic_vasculature        1.010040                    3                       [gata2a, gata5, gata6]
      22_4 hematopoietic_vasculature        1.003967                    1                                     [gata1a]
      25_7 hematopoietic_vasculature        0.999885                    3                      [gata1a, gata2a, gata3]
       0_1           enteric_neurons        0.997933                    1                                     [hoxa2b]
      34_0              neural_crest        0.997604                    3                        [meox1, sox10, sox9b]
       2_2           enteric_neurons        0.996792                    4                 [sox19a, sox19b, sox2, sox3]
      10_4               fast_muscle        0.992655                    1                                      [olig2]
      25_1 hematopoietic_vasculature        0.980245                    6 [gata1a, gata2a, gata3, gata4, gata5, gata6]
      25_3 hematopoietic_vasculature        0.973983                    6 [gata1a, gata2a, gata3, gata5, pax6a, pax6b]
     13_12              neural_optic        0.973630                    6   [sox10, sox19a, sox19b, sox2, sox3, sox9b]

================================================================================
TOP 20 MOST DYNAMIC CLUSTERS (DETAILED)
================================================================================
   cluster_id                   celltype  dynamics_score  n_developmental_tfs  dev_tf_turnover_rate  edge_turnover_rate                        developmental_tfs_list
31       25_6  hematopoietic_vasculature        1.010040                    3                   1.0                 1.0                        [gata2a, gata5, gata6]
57       22_4  hematopoietic_vasculature        1.003967                    1                   1.0                 1.0                                      [gata1a]
30       25_7  hematopoietic_vasculature        0.999885                    3                   1.0                 1.0                       [gata1a, gata2a, gata3]
73        0_1            enteric_neurons        0.997933                    1                   1.0                 1.0                                      [hoxa2b]
80       34_0               neural_crest        0.997604                    3                   1.0                 1.0                         [meox1, sox10, sox9b]
47        2_2            enteric_neurons        0.996792                    4                   1.0                 1.0                  [sox19a, sox19b, sox2, sox3]
78       10_4                fast_muscle        0.992655                    1                   1.0                 1.0                                       [olig2]
12       25_1  hematopoietic_vasculature        0.980245                    6                   1.0                 1.0  [gata1a, gata2a, gata3, gata4, gata5, gata6]
48       25_3  hematopoietic_vasculature        0.973983                    6                   1.0                 1.0  [gata1a, gata2a, gata3, gata5, pax6a, pax6b]
61      13_12               neural_optic        0.973630                    6                   1.0                 1.0    [sox10, sox19a, sox19b, sox2, sox3, sox9b]
63        3_1                  optic_cup        0.973001                    2                   1.0                 1.0                                [pax6a, pax6b]
3        10_7                fast_muscle        0.971968                    1                   1.0                 1.0                                       [olig2]
56       25_2             hemangioblasts        0.970711                    2                   1.0                 1.0                              [gata1a, gata2a]
52        5_1            enteric_neurons        0.969383                    4                   1.0                 1.0                  [meox1, sox10, sox9a, sox9b]
22        7_4    differentiating_neurons        0.967665                    3                   1.0                 1.0                           [sox2, sox3, sox9b]
44        3_5                  optic_cup        0.965917                    3                   1.0                 1.0                         [meox1, pax6a, pax6b]
34       18_9             hatching_gland        0.965127                    1                   1.0                 1.0                                       [sox10]
69       34_3               neural_crest        0.963828                    5                   1.0                 1.0            [sox10, sox19a, sox2, sox3, sox9b]
14      18_10             hatching_gland        0.961881                    2                   1.0                 1.0                                 [sox10, sox3]
59      26_11             hemangioblasts        0.961042                    4                   1.0                 1.0                [gata1a, gata2a, gata5, gata6]

================================================================================
ANALYSIS COMPLETE!
================================================================================
Results saved to: /hpc/projects/data.science/yangjoon.kim/zebrahub_multiome/zebrahub-multiome-analysis/figures/sub_GRNs_reg_programs/cluster_ranking_temporal_dynamics.csv
Use df_ranked to explore further or run visualizations.
