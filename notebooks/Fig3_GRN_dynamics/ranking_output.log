================================================================================
TEMPORAL DYNAMICS RANKING PIPELINE
================================================================================

1. Loading data...
   ✓ Loaded df_clusters_groups: (402, 190)
   ✓ Loaded GRN dictionary: 189 celltype×timepoint combinations
   ✓ Loaded cluster_tf_gene_matrices: 346 clusters

2. Defining analysis functions...

================================================================================

3. Starting analysis of 346 clusters...
Processing clusters:   0%|          | 0/346 [00:00<?, ?it/s]Processing clusters:   1%|          | 2/346 [00:00<00:28, 12.02it/s]Processing clusters:   1%|          | 4/346 [00:00<00:44,  7.69it/s]Processing clusters:   1%|▏         | 5/346 [00:00<00:43,  7.92it/s]Processing clusters:   2%|▏         | 7/346 [00:01<01:09,  4.86it/s]Processing clusters:   2%|▏         | 8/346 [00:01<01:02,  5.42it/s]Processing clusters:   3%|▎         | 10/346 [00:01<00:51,  6.52it/s]Processing clusters:   3%|▎         | 11/346 [00:01<00:54,  6.10it/s]Processing clusters:   4%|▍         | 13/346 [00:01<00:42,  7.85it/s]Processing clusters:   4%|▍         | 15/346 [00:02<00:36,  8.99it/s]Processing clusters:   5%|▍         | 17/346 [00:02<00:34,  9.63it/s]Processing clusters:   5%|▌         | 19/346 [00:02<00:31, 10.29it/s]Processing clusters:   6%|▌         | 21/346 [00:02<00:39,  8.22it/s]Processing clusters:   6%|▋         | 22/346 [00:02<00:40,  7.92it/s]Processing clusters:   7%|▋         | 24/346 [00:03<00:39,  8.24it/s]Processing clusters:   7%|▋         | 25/346 [00:03<00:38,  8.29it/s]Processing clusters:   8%|▊         | 27/346 [00:03<00:35,  9.04it/s]Processing clusters:   8%|▊         | 29/346 [00:03<00:36,  8.62it/s]Processing clusters:   9%|▉         | 31/346 [00:04<00:42,  7.42it/s]Processing clusters:  10%|▉         | 33/346 [00:04<00:36,  8.51it/s]Processing clusters:  10%|█         | 35/346 [00:04<00:33,  9.40it/s]Processing clusters:  11%|█         | 37/346 [00:04<00:30, 10.04it/s]Processing clusters:  11%|█▏        | 39/346 [00:04<00:29, 10.46it/s]Processing clusters:  12%|█▏        | 41/346 [00:04<00:28, 10.86it/s]Processing clusters:  12%|█▏        | 43/346 [00:05<00:26, 11.43it/s]Processing clusters:  13%|█▎        | 45/346 [00:05<00:31,  9.51it/s]Processing clusters:  14%|█▎        | 47/346 [00:05<00:29, 10.14it/s]Processing clusters:  14%|█▍        | 49/346 [00:05<00:27, 10.70it/s]Processing clusters:  15%|█▍        | 51/346 [00:05<00:30,  9.73it/s]Processing clusters:  15%|█▌        | 53/346 [00:06<00:42,  6.81it/s]Processing clusters:  16%|█▌        | 54/346 [00:06<00:41,  7.09it/s]Processing clusters:  16%|█▌        | 55/346 [00:06<00:39,  7.46it/s]Processing clusters:  16%|█▋        | 57/346 [00:06<00:35,  8.24it/s]Processing clusters:  17%|█▋        | 59/346 [00:06<00:30,  9.30it/s]Processing clusters:  18%|█▊        | 61/346 [00:07<00:38,  7.41it/s]Processing clusters:  18%|█▊        | 63/346 [00:07<00:33,  8.40it/s]Processing clusters:  18%|█▊        | 64/346 [00:07<00:40,  6.89it/s]Processing clusters:  19%|█▉        | 66/346 [00:07<00:34,  8.11it/s]Processing clusters:  19%|█▉        | 67/346 [00:08<00:35,  7.93it/s]Processing clusters:  20%|█▉        | 69/346 [00:08<00:31,  8.89it/s]Processing clusters:  20%|██        | 70/346 [00:08<00:31,  8.84it/s]Processing clusters:  21%|██        | 72/346 [00:08<00:28,  9.66it/s]Processing clusters:  21%|██        | 73/346 [00:08<00:31,  8.62it/s]Processing clusters:  22%|██▏       | 75/346 [00:08<00:27,  9.94it/s]Processing clusters:  22%|██▏       | 77/346 [00:09<00:26, 10.13it/s]Processing clusters:  23%|██▎       | 79/346 [00:09<00:24, 10.80it/s]Processing clusters:  23%|██▎       | 81/346 [00:09<00:24, 10.97it/s]Processing clusters:  24%|██▍       | 83/346 [00:09<00:24, 10.58it/s]Processing clusters:  25%|██▍       | 85/346 [00:09<00:23, 11.11it/s]Processing clusters:  25%|██▌       | 87/346 [00:09<00:22, 11.48it/s]Processing clusters:  26%|██▌       | 89/346 [00:10<00:22, 11.57it/s]Processing clusters:  26%|██▋       | 91/346 [00:10<00:22, 11.25it/s]Processing clusters:  27%|██▋       | 93/346 [00:10<00:22, 11.18it/s]Processing clusters:  27%|██▋       | 95/346 [00:10<00:22, 11.27it/s]Processing clusters:  28%|██▊       | 97/346 [00:10<00:21, 11.61it/s]Processing clusters:  29%|██▊       | 99/346 [00:11<00:24, 10.03it/s]Processing clusters:  29%|██▉       | 101/346 [00:11<00:25,  9.45it/s]Processing clusters:  30%|██▉       | 103/346 [00:11<00:25,  9.67it/s]Processing clusters:  30%|███       | 105/346 [00:11<00:26,  9.13it/s]Processing clusters:  31%|███       | 106/346 [00:11<00:26,  8.97it/s]Processing clusters:  31%|███       | 108/346 [00:12<00:24,  9.75it/s]Processing clusters:  32%|███▏      | 110/346 [00:12<00:22, 10.28it/s]Processing clusters:  32%|███▏      | 112/346 [00:12<00:27,  8.40it/s]Processing clusters:  33%|███▎      | 114/346 [00:12<00:24,  9.28it/s]Processing clusters:  34%|███▎      | 116/346 [00:12<00:23,  9.89it/s]Processing clusters:  34%|███▍      | 118/346 [00:13<00:21, 10.58it/s]Processing clusters:  35%|███▍      | 120/346 [00:13<00:20, 10.90it/s]Processing clusters:  35%|███▌      | 122/346 [00:13<00:19, 11.33it/s]Processing clusters:  36%|███▌      | 124/346 [00:13<00:19, 11.66it/s]Processing clusters:  36%|███▋      | 126/346 [00:13<00:18, 11.76it/s]Processing clusters:  37%|███▋      | 128/346 [00:14<00:26,  8.23it/s]Processing clusters:  37%|███▋      | 129/346 [00:14<00:26,  8.05it/s]Processing clusters:  38%|███▊      | 130/346 [00:14<00:26,  8.30it/s]Processing clusters:  38%|███▊      | 132/346 [00:14<00:22,  9.37it/s]Processing clusters:  39%|███▊      | 134/346 [00:14<00:21,  9.91it/s]Processing clusters:  39%|███▉      | 136/346 [00:14<00:19, 10.51it/s]Processing clusters:  40%|███▉      | 138/346 [00:15<00:24,  8.62it/s]Processing clusters:  40%|████      | 140/346 [00:15<00:23,  8.65it/s]Processing clusters:  41%|████      | 142/346 [00:15<00:21,  9.56it/s]Processing clusters:  42%|████▏     | 144/346 [00:15<00:19, 10.26it/s]Processing clusters:  42%|████▏     | 146/346 [00:15<00:18, 10.78it/s]Processing clusters:  43%|████▎     | 148/346 [00:16<00:18, 10.62it/s]Processing clusters:  43%|████▎     | 150/346 [00:16<00:17, 11.27it/s]Processing clusters:  44%|████▍     | 152/346 [00:16<00:17, 11.34it/s]Processing clusters:  45%|████▍     | 154/346 [00:16<00:16, 11.71it/s]Processing clusters:  45%|████▌     | 156/346 [00:16<00:16, 11.52it/s]Processing clusters:  46%|████▌     | 158/346 [00:16<00:15, 11.79it/s]Processing clusters:  46%|████▌     | 160/346 [00:17<00:15, 11.73it/s]Processing clusters:  47%|████▋     | 162/346 [00:17<00:16, 11.21it/s]Processing clusters:  47%|████▋     | 164/346 [00:17<00:19,  9.44it/s]Processing clusters:  48%|████▊     | 166/346 [00:17<00:18,  9.51it/s]Processing clusters:  49%|████▊     | 168/346 [00:17<00:18,  9.83it/s]Processing clusters:  49%|████▉     | 170/346 [00:18<00:16, 10.50it/s]Processing clusters:  50%|████▉     | 172/346 [00:18<00:15, 11.02it/s]Processing clusters:  50%|█████     | 174/346 [00:18<00:15, 11.46it/s]Processing clusters:  51%|█████     | 176/346 [00:18<00:15, 10.88it/s]Processing clusters:  51%|█████▏    | 178/346 [00:18<00:14, 11.30it/s]Processing clusters:  52%|█████▏    | 180/346 [00:18<00:14, 11.64it/s]Processing clusters:  53%|█████▎    | 182/346 [00:19<00:13, 11.88it/s]Processing clusters:  53%|█████▎    | 184/346 [00:19<00:14, 11.16it/s]Processing clusters:  54%|█████▍    | 186/346 [00:19<00:13, 11.56it/s]Processing clusters:  54%|█████▍    | 188/346 [00:19<00:13, 11.77it/s]Processing clusters:  55%|█████▍    | 190/346 [00:19<00:13, 11.65it/s]Processing clusters:  55%|█████▌    | 192/346 [00:19<00:13, 11.79it/s]Processing clusters:  56%|█████▌    | 194/346 [00:20<00:12, 12.00it/s]Processing clusters:  57%|█████▋    | 196/346 [00:20<00:12, 12.43it/s]Processing clusters:  57%|█████▋    | 198/346 [00:20<00:15,  9.43it/s]Processing clusters:  58%|█████▊    | 200/346 [00:20<00:14,  9.85it/s]Processing clusters:  58%|█████▊    | 202/346 [00:20<00:14, 10.28it/s]Processing clusters:  59%|█████▉    | 204/346 [00:21<00:15,  9.30it/s]Processing clusters:  60%|█████▉    | 206/346 [00:21<00:14,  9.78it/s]Processing clusters:  60%|██████    | 208/346 [00:21<00:14,  9.44it/s]Processing clusters:  61%|██████    | 210/346 [00:21<00:13, 10.32it/s]Processing clusters:  61%|██████▏   | 212/346 [00:21<00:12, 11.11it/s]Processing clusters:  62%|██████▏   | 214/346 [00:22<00:11, 11.04it/s]Processing clusters:  62%|██████▏   | 216/346 [00:22<00:11, 10.86it/s]Processing clusters:  63%|██████▎   | 218/346 [00:22<00:11, 11.34it/s]Processing clusters:  64%|██████▎   | 220/346 [00:22<00:10, 11.66it/s]Processing clusters:  64%|██████▍   | 222/346 [00:22<00:10, 11.89it/s]Processing clusters:  65%|██████▍   | 224/346 [00:22<00:10, 11.43it/s]Processing clusters:  65%|██████▌   | 226/346 [00:23<00:10, 11.66it/s]Processing clusters:  66%|██████▌   | 228/346 [00:23<00:10, 11.78it/s]Processing clusters:  66%|██████▋   | 230/346 [00:23<00:09, 11.97it/s]Processing clusters:  67%|██████▋   | 232/346 [00:23<00:09, 11.93it/s]Processing clusters:  68%|██████▊   | 234/346 [00:23<00:09, 12.02it/s]Processing clusters:  68%|██████▊   | 236/346 [00:23<00:09, 12.01it/s]Processing clusters:  69%|██████▉   | 238/346 [00:24<00:09, 11.37it/s]Processing clusters:  69%|██████▉   | 240/346 [00:24<00:09, 11.31it/s]Processing clusters:  70%|██████▉   | 242/346 [00:24<00:08, 11.64it/s]Processing clusters:  71%|███████   | 244/346 [00:24<00:08, 11.80it/s]Processing clusters:  71%|███████   | 246/346 [00:24<00:08, 11.92it/s]Processing clusters:  72%|███████▏  | 248/346 [00:25<00:08, 11.72it/s]Processing clusters:  72%|███████▏  | 250/346 [00:25<00:07, 12.25it/s]Processing clusters:  73%|███████▎  | 252/346 [00:25<00:07, 12.36it/s]Processing clusters:  73%|███████▎  | 254/346 [00:25<00:07, 12.31it/s]Processing clusters:  74%|███████▍  | 256/346 [00:25<00:07, 12.24it/s]Processing clusters:  75%|███████▍  | 258/346 [00:25<00:07, 12.33it/s]Processing clusters:  75%|███████▌  | 260/346 [00:25<00:06, 12.44it/s]Processing clusters:  76%|███████▌  | 262/346 [00:26<00:06, 12.42it/s]Processing clusters:  76%|███████▋  | 264/346 [00:26<00:06, 12.43it/s]Processing clusters:  77%|███████▋  | 266/346 [00:26<00:06, 12.42it/s]Processing clusters:  77%|███████▋  | 268/346 [00:26<00:06, 12.52it/s]Processing clusters:  78%|███████▊  | 270/346 [00:26<00:06, 12.22it/s]Processing clusters:  79%|███████▊  | 272/346 [00:26<00:06, 12.30it/s]Processing clusters:  79%|███████▉  | 274/346 [00:27<00:06, 11.30it/s]Processing clusters:  80%|███████▉  | 276/346 [00:27<00:06, 11.43it/s]Processing clusters:  80%|████████  | 278/346 [00:27<00:05, 11.44it/s]Processing clusters:  81%|████████  | 280/346 [00:27<00:05, 11.67it/s]Processing clusters:  82%|████████▏ | 282/346 [00:27<00:05, 11.92it/s]Processing clusters:  82%|████████▏ | 284/346 [00:28<00:05, 11.73it/s]Processing clusters:  83%|████████▎ | 286/346 [00:28<00:05, 10.47it/s]Processing clusters:  83%|████████▎ | 288/346 [00:28<00:05, 11.13it/s]Processing clusters:  84%|████████▍ | 290/346 [00:28<00:04, 11.47it/s]Processing clusters:  84%|████████▍ | 292/346 [00:28<00:04, 11.43it/s]Processing clusters:  85%|████████▍ | 294/346 [00:29<00:05,  9.10it/s]Processing clusters:  85%|████████▌ | 295/346 [00:29<00:06,  7.52it/s]Processing clusters:  86%|████████▌ | 297/346 [00:29<00:05,  8.64it/s]Processing clusters:  86%|████████▋ | 299/346 [00:29<00:05,  9.15it/s]Processing clusters:  87%|████████▋ | 301/346 [00:29<00:04,  9.04it/s]Processing clusters:  88%|████████▊ | 303/346 [00:30<00:04,  9.89it/s]Processing clusters:  88%|████████▊ | 305/346 [00:30<00:03, 10.56it/s]Processing clusters:  89%|████████▊ | 307/346 [00:30<00:03, 10.95it/s]Processing clusters:  89%|████████▉ | 309/346 [00:30<00:03, 11.30it/s]Processing clusters:  90%|████████▉ | 311/346 [00:30<00:03, 11.60it/s]Processing clusters:  90%|█████████ | 313/346 [00:30<00:02, 11.69it/s]Processing clusters:  91%|█████████ | 315/346 [00:31<00:02, 12.20it/s]Processing clusters:  92%|█████████▏| 317/346 [00:31<00:02, 12.05it/s]Processing clusters:  92%|█████████▏| 319/346 [00:31<00:02, 12.10it/s]Processing clusters:  93%|█████████▎| 321/346 [00:31<00:02, 12.11it/s]Processing clusters:  93%|█████████▎| 323/346 [00:31<00:01, 12.27it/s]Processing clusters:  94%|█████████▍| 325/346 [00:31<00:01, 12.32it/s]Processing clusters:  95%|█████████▍| 327/346 [00:31<00:01, 12.30it/s]Processing clusters:  95%|█████████▌| 329/346 [00:32<00:01, 11.69it/s]Processing clusters:  96%|█████████▌| 331/346 [00:32<00:01, 11.51it/s]Processing clusters:  96%|█████████▌| 333/346 [00:32<00:01, 11.47it/s]Processing clusters:  97%|█████████▋| 335/346 [00:32<00:00, 12.02it/s]Processing clusters:  97%|█████████▋| 337/346 [00:32<00:00, 11.93it/s]Processing clusters:  98%|█████████▊| 339/346 [00:33<00:00, 11.99it/s]Processing clusters:  99%|█████████▊| 341/346 [00:33<00:00, 12.20it/s]Processing clusters:  99%|█████████▉| 343/346 [00:33<00:00, 12.15it/s]Processing clusters: 100%|█████████▉| 345/346 [00:33<00:00, 12.15it/s]Processing clusters: 100%|██████████| 346/346 [00:33<00:00, 10.29it/s]

   ✓ Ranking table saved to: /hpc/projects/data.science/yangjoon.kim/zebrahub_multiome/zebrahub-multiome-analysis/figures/sub_GRNs_reg_programs/cluster_ranking_temporal_dynamics.csv

================================================================================
RANKING SUMMARY
================================================================================
Total clusters analyzed: 196
Dynamics score range: 0.433 - 1.124
Median dynamics score: 0.724

Top 10 most dynamic clusters:
cluster_id              celltype  dynamics_score  n_developmental_tfs developmental_tfs_list
     12_12       enteric_neurons        1.123607                    1               [gata1a]
     19_12 primordial_germ_cells        1.123607                    1                [sox10]
      7_12          neural_crest        1.123607                    1                 [sox3]
      12_2       enteric_neurons        1.123607                    2         [sox10, sox9b]
      13_4             optic_cup        1.100000                    1                [meox1]
       2_5       enteric_neurons        1.065831                    2         [pax6a, pax6b]
      17_4 primordial_germ_cells        1.052753                    2         [gata5, gata6]
       7_3          neural_crest        1.052753                    2          [sox10, sox3]
      24_7        hatching_gland        1.041421                    1                [gata6]
       1_9             epidermis        1.041421                    2        [sox19a, sox9b]

================================================================================
TOP 20 MOST DYNAMIC CLUSTERS (DETAILED)
================================================================================
    cluster_id                   celltype  dynamics_score  n_developmental_tfs  dev_tf_turnover_rate  edge_turnover_rate   developmental_tfs_list
175      12_12            enteric_neurons        1.123607                    1                   1.0                 1.0                 [gata1a]
72       19_12      primordial_germ_cells        1.123607                    1                   1.0                 1.0                  [sox10]
114       7_12               neural_crest        1.123607                    1                   1.0                 1.0                   [sox3]
178       12_2            enteric_neurons        1.123607                    2                   1.0                 1.0           [sox10, sox9b]
52        13_4                  optic_cup        1.100000                    1                   1.0                 1.0                  [meox1]
50         2_5            enteric_neurons        1.065831                    2                   1.0                 1.0           [pax6a, pax6b]
41        17_4      primordial_germ_cells        1.052753                    2                   1.0                 1.0           [gata5, gata6]
139        7_3               neural_crest        1.052753                    2                   1.0                 1.0            [sox10, sox3]
138       24_7             hatching_gland        1.041421                    1                   1.0                 1.0                  [gata6]
140        1_9                  epidermis        1.041421                    2                   1.0                 1.0          [sox19a, sox9b]
187       22_5                  epidermis        1.019583                    3                   1.0                 1.0   [gata2a, pax6a, pax6b]
120       28_0            enteric_neurons        1.016069                    1                   1.0                 1.0                  [sox9a]
145       22_8                  epidermis        1.013137                    1                   1.0                 1.0                  [pax2a]
45        7_13                   endoderm        1.010969                    3                   1.0                 1.0     [sox10, sox3, sox9b]
67        25_6  hematopoietic_vasculature        1.010040                    3                   1.0                 1.0   [gata2a, gata5, gata6]
124       22_4                  epidermis        1.007703                    1                   1.0                 1.0                 [gata2a]
0        12_10            enteric_neurons        1.007703                    2                   1.0                 1.0           [pax6a, pax6b]
53        14_5                   endoderm        1.006586                    3                   1.0                 1.0   [gata2a, gata5, gata6]
66        25_7  hematopoietic_vasculature        0.999885                    3                   1.0                 1.0  [gata1a, gata2a, gata3]
167        0_1            enteric_neurons        0.997933                    1                   1.0                 1.0                 [hoxa2b]

================================================================================
ANALYSIS COMPLETE!
================================================================================
Results saved to: /hpc/projects/data.science/yangjoon.kim/zebrahub_multiome/zebrahub-multiome-analysis/figures/sub_GRNs_reg_programs/cluster_ranking_temporal_dynamics.csv
Use df_ranked to explore further or run visualizations.
